<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Chats"
             x:Class="plz_fix.pages.dash.chat"
             BackgroundColor="White">

    <VerticalStackLayout Spacing="20" Padding="0, 10, 0, 10" VerticalOptions="FillAndExpand">

      

        <!-- Search Bar (Smaller and with Padding) -->
        <SearchBar Placeholder="Search for chats..."
                   Margin="0,20,0,0"
                   BackgroundColor="White"
                   TextColor="Black"
                   PlaceholderColor="Gray"
                   HorizontalOptions="FillAndExpand"
                   HeightRequest="40"/>

        <!-- Chat List -->
        <CollectionView ItemsSource="{Binding Chats}" SelectionMode="None" BackgroundColor="Transparent">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="10"
                           Margin="5,0"
                          Background="Transparent"
                          >

                        <StackLayout Orientation="Horizontal" Spacing="15">
                            <!-- Profile Picture -->
                            <Frame WidthRequest="50" HeightRequest="50" CornerRadius="25" BackgroundColor="LightGray" HasShadow="False">
                                <Image Source="{Binding ProfileImage}" WidthRequest="50" HeightRequest="50" Aspect="AspectFill"/>
                            </Frame>

                            <!-- Chat Details -->
                            <StackLayout VerticalOptions="Center" HorizontalOptions="FillAndExpand">
                                <Label Text="{Binding Name}" FontSize="16" FontAttributes="Bold" TextColor="Black"/>
                                <Label Text="{Binding LastMessage}" FontSize="14" TextColor="Gray"/>
                            </StackLayout>

                            <!-- Unread Notification Badge (Placed after the chat details) -->
                            <Frame BackgroundColor="Blue" Padding="0" CornerRadius="15"
                                   HorizontalOptions="End" VerticalOptions="Center"
                                   WidthRequest="30" HeightRequest="30"
                                   IsVisible="{Binding HasUnreadMessages}">
                                <Label Text="{Binding UnreadMessages}" TextColor="White" FontSize="12"
                                       HorizontalTextAlignment="Center"
                                       VerticalTextAlignment="Center"/>
                            </Frame>

                        </StackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </VerticalStackLayout>
</ContentPage>
